import matplotlib.pyplot as plt
import numpy as np

n = 290
y_data = [22, 28, 33, 40, 48, 55, 64, 72, 83, 93, 104, 115, 130, 141, 158, 162, 185, 194, 212, 230, 252, 269, 279, 298, 315, 346, 359, 379, 402, 414, 439, 462, 493, 525, 545, 580, 594, 621, 658, 682, 706, 731, 757, 778, 840, 864, 883, 929, 963, 977, 1055, 1032, 1083, 1118, 1183, 1231, 1243, 1277, 1346, 1347, 1417, 1455, 1494, 1521, 1609, 1595, 1630, 1697, 1776, 1790, 1850, 1832, 1918, 1948, 2057, 2068, 2173, 2215, 2256, 2315, 2349, 2412, 2486, 2496, 2522, 2601, 2689, 2718, 2802, 2763, 2920, 2982, 3027, 3049, 3117, 3195, 3179, 3245, 3452, 3485, 3521, 3506, 3724, 3680, 3783, 3834, 3816, 4011, 3933, 4059, 4099, 4344, 4290, 4317, 4496, 4543, 4670, 4615, 4745, 4846, 4949, 4979, 5126, 5103, 5299, 5194, 5401, 5385, 5597, 5654, 5728, 5787, 5834, 5987, 6048, 6276, 5980, 6334, 6342, 6303, 6617, 6531, 6848, 6590, 6791, 6980, 6903, 7356, 7181, 7430, 7390, 7435, 7735, 7902, 8032, 7938, 7913, 8211, 8358, 8285, 8392, 8314, 8614, 8553, 9051, 8906, 9011, 9077, 9472, 9103, 9648, 9723, 9722, 9709, 9798, 9879, 10188, 10162, 10329, 10124, 10807, 10526, 10584, 10831, 10799, 11015, 11150, 11430, 11472, 11599, 11782, 11905, 12256, 12033, 11835, 12144, 12462, 12545, 12537, 12370, 12689, 12801, 13398, 13188, 13186, 13572, 14023, 14100, 13782, 13950, 14288, 14232, 14536, 14556, 14328, 15046, 15033, 14965, 15092, 15672, 15282, 15653, 15607, 15744, 15971, 16047, 16549, 16825, 16673, 16729, 16678, 16919, 17082, 17451, 17204, 17104, 17383, 17733, 18227, 17921, 18389, 18795, 18496, 18887, 19295, 19121, 19422, 19818, 19361, 19826, 19755, 20070, 19770, 20400, 20123, 20783, 21244, 20728, 21270, 20527, 20931, 21408, 20743, 21022, 21853, 22084, 22726, 23161, 22462, 22569, 23245, 22749, 23433, 23379, 23351, 23107, 24131, 24241, 24026, 24990, 24745, 25000, 25052, 24927, 25711, 24630, 25231, 25894, 26635, 26923]
x_data = [10 + i for i in range(n)]

x_data = np.log(x_data)
y_data = np.log(y_data)
print(x_data)

sumxy = sumx = sumy = sumxx = 0

for i in range(n):
    sumxy += x_data[i] * y_data[i]
    sumx += x_data[i]
    sumy += y_data[i]
    sumxx += x_data[i] ** 2

k = (sumxy / n - (sumx / n) * (sumy / n)) / (sumxx / n - (sumx / n) ** 2)
b = (sumy / n) - k * (sumx / n)

x1 = np.arange(2, 5.75, 0.01)

plt.figure()
plt.errorbar(x_data, y_data, fmt='.', color='red', linewidth=0.7)
plt.plot(x1, k * x1 + b, label=r'$y = 2.11 x - 1.84$', linewidth=1.2)

plt.legend()

plt.grid(True)
plt.show()

print(k, b)
